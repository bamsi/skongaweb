!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(self.webpackChunkangular=self.webpackChunkangular||[]).push([[246],{13246:function(n,i,o){"use strict";o.r(i),o.d(i,{StudentModule:function(){return P}});var a=o(61511),s=o(57629),l=o(65042),r=o(92290),u=o(31572),d=o(29063),p=o(60898),c=o(51146),g=o(68751),Z=o(76397),h=o(74568),f=o(16073),_=o(63240),T=o(20322),A=o(69892),m=o(46726);function q(t,e){1&t&&(u._UZ(0,"i",20),u.TgZ(1,"span",21),u._uU(2," Registered students"),u.qZA())}function v(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"div",22),u.TgZ(1,"input",23,24),u.NdJ("change",function(t){return u.CHM(n),u.oxw().onFileChange(t)}),u.qZA(),u.qZA()}}function b(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"div",25),u.TgZ(1,"h5",26),u._uU(2,"Record Students"),u.qZA(),u.TgZ(3,"span",27),u._UZ(4,"i",28),u.TgZ(5,"input",29),u.NdJ("input",function(t){return u.CHM(n),u.oxw(),u.MAs(24).filterGlobal(t.target.value,"contains")}),u.qZA(),u.qZA(),u.qZA()}}function U(t,e){1&t&&(u.TgZ(0,"tr"),u.TgZ(1,"th",30),u._uU(2,"Student ID "),u._UZ(3,"p-sortIcon",31),u.qZA(),u.TgZ(4,"th",32),u._uU(5,"Name "),u._UZ(6,"p-sortIcon",33),u.qZA(),u.TgZ(7,"th",34),u._uU(8,"Gender "),u._UZ(9,"p-sortIcon",35),u.qZA(),u.TgZ(10,"th",36),u._uU(11,"Phone "),u._UZ(12,"p-sortIcon",37),u.qZA(),u.TgZ(13,"th",38),u._uU(14,"Email "),u._UZ(15,"p-sortIcon",39),u.qZA(),u._UZ(16,"th"),u.qZA())}function y(t,e){if(1&t&&(u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td"),u._uU(6),u.qZA(),u.TgZ(7,"td"),u._uU(8),u.qZA(),u.TgZ(9,"td"),u._uU(10),u.qZA(),u._UZ(11,"td"),u.qZA()),2&t){var n=e.$implicit;u.xp6(2),u.Oqu(n.student_id),u.xp6(2),u.Oqu(n.name),u.xp6(2),u.Oqu(n.gender),u.xp6(2),u.Oqu(n.phone),u.xp6(2),u.Oqu(n.email)}}function w(t,e){if(1&t&&(u.TgZ(0,"div",25),u._uU(1),u.qZA()),2&t){var n=u.oxw();u.xp6(1),u.hij(" In total there are ",null!=n.students&&n.students.data?n.students.length:0," students. ")}}function x(t,e){1&t&&(u.TgZ(0,"tr",40),u.TgZ(1,"th"),u._uU(2,"PREFERRED ID"),u.qZA(),u.TgZ(3,"th"),u._uU(4,"FIRST NAAME "),u.qZA(),u.TgZ(5,"th"),u._uU(6,"MIDDLE NAME"),u.qZA(),u.TgZ(7,"th"),u._uU(8,"LAST NAME"),u.qZA(),u.TgZ(9,"th"),u._uU(10,"GENDER"),u.qZA(),u.TgZ(11,"th"),u._uU(12,"PHONE"),u.qZA(),u.qZA())}function S(t,e){if(1&t&&(u.TgZ(0,"tr",41),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td"),u._uU(6),u.qZA(),u.TgZ(7,"td"),u._uU(8),u.qZA(),u.TgZ(9,"td"),u._uU(10),u.qZA(),u.TgZ(11,"td"),u._uU(12),u.qZA(),u.qZA()),2&t){var n=e.$implicit;u.xp6(2),u.Oqu(n.PREFERRED_ID),u.xp6(2),u.Oqu(n.FIRST_NAME),u.xp6(2),u.Oqu(n.MIDDLE_NAME),u.xp6(2),u.Oqu(n.LAST_NAME),u.xp6(2),u.Oqu(n.GENDER),u.xp6(2),u.Oqu(n.PHONE)}}function C(t,e){if(1&t){var n=u.EpF();u.TgZ(0,"p-button",42),u.NdJ("click",function(){return u.CHM(n),u.oxw().display=!1}),u.qZA(),u.TgZ(1,"p-button",43),u.NdJ("click",function(){return u.CHM(n),u.oxw().uploadStudent()}),u.qZA()}}var N,E,R=function(){return["student_id","name","gender","phone","email"]},M=function(){return{width:"60vw"}},I=function(){return[10,25,50]},k=[{path:"registration",component:(N=function(){function n(e,i,o){t(this,n),this.http=e,this.ls=i,this.messageService=o,this.display=!1}var i,a,s;return i=n,(a=[{key:"ngOnInit",value:function(){var t=this,e=this.ls.getItem("APP_USER");this.institution_id=null==e?void 0:e.user.institution_id,this.getGrade().subscribe(function(e){t.grades=e},function(t){return console.log("oops",t)}),this.getSchoolCalendar().subscribe(function(e){t.school_calendar=e},function(t){return console.log("oops",t)})}},{key:"getGrade",value:function(){return this.http.get("".concat(l.N.apiURL,"/grade/")+this.institution_id)}},{key:"getSchoolCalendar",value:function(){return this.http.get("".concat(l.N.apiURL,"/school_calendar/")+this.institution_id)}},{key:"getStudents",value:function(){var t=this;this.school_calendar_id&&this.class_id&&this.http.get("".concat(l.N.apiURL,"/students/")+this.institution_id+"/"+this.class_id+"/"+this.school_calendar_id).subscribe(function(e){return t.students=e},function(t){return console.log("oops",t)})}},{key:"onFileChange",value:function(t){var e=this;try{o.e(153).then(o.t.bind(o,31153,23)).then(function(n){var i=null,o=null,a=new FileReader;a.onload=function(t){i=n.read(a.result,{type:"binary"}),o=i.SheetNames.reduce(function(t,e){return t[e]=n.utils.sheet_to_json(i.Sheets[e]),t},{}),e.data_file=o[Object.keys(o)[0]],e.display=!0},a.readAsBinaryString(t.target.files[0])})}catch(t){console.log("error",t)}}},{key:"uploadStudent",value:function(){var t=this,e={school_calendar_id:this.school_calendar_id,class_id:this.class_id,students:this.data_file,institution_id:this.institution_id};this.display=!1,this.http.post("".concat(l.N.apiURL,"/import_students"),e).subscribe(function(e){var n,i;t.res=e,t.students={data:null===(n=t.res)||void 0===n?void 0:n.data},t.messageService.add({key:"success",severity:"success",summary:"Success Message",detail:null===(i=t.res)||void 0===i?void 0:i.message})},function(e){return t.error="Error occured, please contact administrator"})}}])&&e(i.prototype,a),s&&e(i,s),n}(),N.\u0275fac=function(t){return new(t||N)(u.Y36(d.eN),u.Y36(p.g),u.Y36(r.ez))},N.\u0275cmp=u.Xpm({type:N,selectors:[["app-registration"]],features:[u._Bn([r.ez])],decls:34,vars:24,consts:[["position","top-right","key","success"],["styleClass","tabview-custom"],["pTemplate","header"],[1,"p-fluid","p-grid"],[1,"p-field","p-col-12","p-md-3","p-mt-2"],[1,"p-float-label"],["inputId","school_calendar","optionLabel","name","optionValue","id",3,"autoDisplayFirst","options","ngModel","ngModelChange"],["for","class"],["inputId","class_id","optionLabel","name","optionValue","id",3,"autoDisplayFirst","options","ngModel","ngModelChange","onChange"],["class","p-field p-col-12 p-md-6 p-mt-4",4,"ngIf"],[1,"p-field","p-col-12","p-md-12"],["routerLink","/assets/documents/sample.xlsx","target","_blank",1,"pi","pi-file-excel"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","paginator","globalFilterFields","rowHover","showCurrentPageReport"],["dt",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","summary"],["header","You are about to upload student data",3,"visible","visibleChange"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","footer"],[1,"pi","pi-user-plus"],[1,"p-ml-2"],[1,"p-field","p-col-12","p-md-6","p-mt-4"],["type","file","size","60",3,"change"],["myInput",""],[1,"p-d-flex","p-ai-center","p-jc-between"],[1,"p-m-0"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search student...",3,"input"],["pSortableColumn","student_id"],["field","student_id"],["pSortableColumn","name"],["field","name"],["pSortableColumn","gender"],["field","gender"],["pSortableColumn","phone"],["field","phone"],["pSortableColumn","email"],["field","email"],[2,"font-size","11px"],[2,"font-size","10px"],["label","Cancel","styleClass","p-button-outlined p-button-danger",3,"click"],["label","Upload data","styleClass","p-button-info",3,"click"]],template:function(t,e){1&t&&(u._UZ(0,"p-toast",0),u.TgZ(1,"p-card"),u.TgZ(2,"p-tabView",1),u.TgZ(3,"p-tabPanel"),u.YNc(4,q,3,0,"ng-template",2),u.TgZ(5,"div",3),u.TgZ(6,"div",4),u.TgZ(7,"span",5),u.TgZ(8,"p-dropdown",6),u.NdJ("ngModelChange",function(t){return e.school_calendar_id=t}),u.qZA(),u.TgZ(9,"label",7),u._uU(10,"Select Calendar Year "),u.qZA(),u.qZA(),u.qZA(),u.TgZ(11,"div",4),u.TgZ(12,"span",5),u.TgZ(13,"p-dropdown",8),u.NdJ("ngModelChange",function(t){return e.class_id=t})("onChange",function(){return e.getStudents()}),u.qZA(),u.TgZ(14,"label",7),u._uU(15,"Select Class"),u.qZA(),u.qZA(),u.qZA(),u.YNc(16,v,3,0,"div",9),u.qZA(),u.TgZ(17,"div",3),u.TgZ(18,"div",10),u.TgZ(19,"p"),u._uU(20," To upload new students to selected class, please upload .xlsx file. "),u.TgZ(21,"a",11),u._uU(22,"download sample"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(23,"p-table",12,13),u.YNc(25,b,6,0,"ng-template",14),u.YNc(26,U,17,0,"ng-template",2),u.YNc(27,y,12,5,"ng-template",15),u.YNc(28,w,2,1,"ng-template",16),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(29,"p-dialog",17),u.NdJ("visibleChange",function(t){return e.display=t}),u.TgZ(30,"p-table",18),u.YNc(31,x,13,0,"ng-template",2),u.YNc(32,S,13,6,"ng-template",15),u.qZA(),u.YNc(33,C,2,0,"ng-template",19),u.qZA()),2&t&&(u.xp6(8),u.Q6J("autoDisplayFirst",!1)("options",null==e.school_calendar?null:e.school_calendar.results)("ngModel",e.school_calendar_id),u.xp6(5),u.Q6J("autoDisplayFirst",!1)("options",null==e.grades?null:e.grades.class)("ngModel",e.class_id),u.xp6(3),u.Q6J("ngIf",e.school_calendar_id&&e.class_id),u.xp6(7),u.Q6J("value",null==e.students?null:e.students.data)("rows",10)("paginator",!0)("globalFilterFields",u.DdM(21,R))("rowHover",!0)("showCurrentPageReport",!0),u.xp6(6),u.Akn(u.DdM(22,M)),u.Q6J("visible",e.display),u.xp6(1),u.Q6J("value",e.data_file)("paginator",!0)("rows",5)("showCurrentPageReport",!0)("rowsPerPageOptions",u.DdM(23,I)))},directives:[c.FN,g.Z,Z.xf,Z.x4,r.jx,h.Lt,f.JJ,f.On,a.O5,s.yS,_.iA,T.V,A.o,_.lQ,_.fz,m.zx],styles:[""]}),N),data:{title:"Register Student",breadcrumb:"Registration",role:"REGISTER_STUDENT"}}],O=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.Bz.forChild(k)],s.Bz]}),e}(),D=o(59165),F=o(22928),P=((E=function e(){t(this,e)}).\u0275fac=function(t){return new(t||E)},E.\u0275mod=u.oAB({type:E}),E.\u0275inj=u.cJS({imports:[[a.ez,O,D.W,f.u5,F.Ob]]}),E)}}])}();