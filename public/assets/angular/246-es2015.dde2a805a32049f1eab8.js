(self.webpackChunkangular=self.webpackChunkangular||[]).push([[246],{13246:function(t,e,n){"use strict";n.r(e),n.d(e,{StudentModule:function(){return O}});var s=n(61511),i=n(57629),o=n(65042),a=n(92290),l=n(31572),r=n(29063),d=n(60898),u=n(51146),p=n(68751),c=n(76397),g=n(74568),Z=n(16073),h=n(63240),_=n(20322),f=n(69892),A=n(46726);function T(t,e){1&t&&(l._UZ(0,"i",20),l.TgZ(1,"span",21),l._uU(2," Registered students"),l.qZA())}function m(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"div",22),l.TgZ(1,"input",23,24),l.NdJ("change",function(e){return l.CHM(t),l.oxw().onFileChange(e)}),l.qZA(),l.qZA()}}function q(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"div",25),l.TgZ(1,"h5",26),l._uU(2,"Record Students"),l.qZA(),l.TgZ(3,"span",27),l._UZ(4,"i",28),l.TgZ(5,"input",29),l.NdJ("input",function(e){return l.CHM(t),l.oxw(),l.MAs(24).filterGlobal(e.target.value,"contains")}),l.qZA(),l.qZA(),l.qZA()}}function b(t,e){1&t&&(l.TgZ(0,"tr"),l.TgZ(1,"th",30),l._uU(2,"Student ID "),l._UZ(3,"p-sortIcon",31),l.qZA(),l.TgZ(4,"th",32),l._uU(5,"Name "),l._UZ(6,"p-sortIcon",33),l.qZA(),l.TgZ(7,"th",34),l._uU(8,"Gender "),l._UZ(9,"p-sortIcon",35),l.qZA(),l.TgZ(10,"th",36),l._uU(11,"Phone "),l._UZ(12,"p-sortIcon",37),l.qZA(),l.TgZ(13,"th",38),l._uU(14,"Email "),l._UZ(15,"p-sortIcon",39),l.qZA(),l._UZ(16,"th"),l.qZA())}function U(t,e){if(1&t&&(l.TgZ(0,"tr"),l.TgZ(1,"td"),l._uU(2),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.qZA(),l.TgZ(5,"td"),l._uU(6),l.qZA(),l.TgZ(7,"td"),l._uU(8),l.qZA(),l.TgZ(9,"td"),l._uU(10),l.qZA(),l._UZ(11,"td"),l.qZA()),2&t){const t=e.$implicit;l.xp6(2),l.Oqu(t.student_id),l.xp6(2),l.Oqu(t.name),l.xp6(2),l.Oqu(t.gender),l.xp6(2),l.Oqu(t.phone),l.xp6(2),l.Oqu(t.email)}}function x(t,e){if(1&t&&(l.TgZ(0,"div",25),l._uU(1),l.qZA()),2&t){const t=l.oxw();l.xp6(1),l.hij(" In total there are ",null!=t.students&&t.students.data?t.students.length:0," students. ")}}function v(t,e){1&t&&(l.TgZ(0,"tr",40),l.TgZ(1,"th"),l._uU(2,"PREFERRED ID"),l.qZA(),l.TgZ(3,"th"),l._uU(4,"FIRST NAAME "),l.qZA(),l.TgZ(5,"th"),l._uU(6,"MIDDLE NAME"),l.qZA(),l.TgZ(7,"th"),l._uU(8,"LAST NAME"),l.qZA(),l.TgZ(9,"th"),l._uU(10,"GENDER"),l.qZA(),l.TgZ(11,"th"),l._uU(12,"PHONE"),l.qZA(),l.qZA())}function S(t,e){if(1&t&&(l.TgZ(0,"tr",41),l.TgZ(1,"td"),l._uU(2),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.qZA(),l.TgZ(5,"td"),l._uU(6),l.qZA(),l.TgZ(7,"td"),l._uU(8),l.qZA(),l.TgZ(9,"td"),l._uU(10),l.qZA(),l.TgZ(11,"td"),l._uU(12),l.qZA(),l.qZA()),2&t){const t=e.$implicit;l.xp6(2),l.Oqu(t.PREFERRED_ID),l.xp6(2),l.Oqu(t.FIRST_NAME),l.xp6(2),l.Oqu(t.MIDDLE_NAME),l.xp6(2),l.Oqu(t.LAST_NAME),l.xp6(2),l.Oqu(t.GENDER),l.xp6(2),l.Oqu(t.PHONE)}}function N(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"p-button",42),l.NdJ("click",function(){return l.CHM(t),l.oxw().display=!1}),l.qZA(),l.TgZ(1,"p-button",43),l.NdJ("click",function(){return l.CHM(t),l.oxw().uploadStudent()}),l.qZA()}}const w=function(){return["student_id","name","gender","phone","email"]},C=function(){return{width:"60vw"}},y=function(){return[10,25,50]},R=[{path:"registration",component:(()=>{class t{constructor(t,e,n){this.http=t,this.ls=e,this.messageService=n,this.display=!1}ngOnInit(){var t=this.ls.getItem("APP_USER");this.institution_id=null==t?void 0:t.user.institution_id,this.getGrade().subscribe(t=>{this.grades=t},t=>console.log("oops",t)),this.getSchoolCalendar().subscribe(t=>{this.school_calendar=t},t=>console.log("oops",t))}getGrade(){return this.http.get(`${o.N.apiURL}/grade/`+this.institution_id)}getSchoolCalendar(){return this.http.get(`${o.N.apiURL}/school_calendar/`+this.institution_id)}getStudents(){this.school_calendar_id&&this.class_id&&this.http.get(`${o.N.apiURL}/students/`+this.institution_id+"/"+this.class_id+"/"+this.school_calendar_id).subscribe(t=>this.students=t,t=>console.log("oops",t))}onFileChange(t){try{n.e(153).then(n.t.bind(n,31153,23)).then(e=>{let n=null,s=null;const i=new FileReader;i.onload=t=>{n=e.read(i.result,{type:"binary"}),s=n.SheetNames.reduce((t,s)=>(t[s]=e.utils.sheet_to_json(n.Sheets[s]),t),{}),this.data_file=s[Object.keys(s)[0]],this.display=!0},i.readAsBinaryString(t.target.files[0])})}catch(t){console.log("error",t)}}uploadStudent(){let t={school_calendar_id:this.school_calendar_id,class_id:this.class_id,students:this.data_file,institution_id:this.institution_id};this.display=!1,this.http.post(`${o.N.apiURL}/import_students`,t).subscribe(t=>{var e,n;this.res=t,this.students={data:null===(e=this.res)||void 0===e?void 0:e.data},this.messageService.add({key:"success",severity:"success",summary:"Success Message",detail:null===(n=this.res)||void 0===n?void 0:n.message})},t=>this.error="Error occured, please contact administrator")}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(r.eN),l.Y36(d.g),l.Y36(a.ez))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-registration"]],features:[l._Bn([a.ez])],decls:34,vars:24,consts:[["position","top-right","key","success"],["styleClass","tabview-custom"],["pTemplate","header"],[1,"p-fluid","p-grid"],[1,"p-field","p-col-12","p-md-3","p-mt-2"],[1,"p-float-label"],["inputId","school_calendar","optionLabel","name","optionValue","id",3,"autoDisplayFirst","options","ngModel","ngModelChange"],["for","class"],["inputId","class_id","optionLabel","name","optionValue","id",3,"autoDisplayFirst","options","ngModel","ngModelChange","onChange"],["class","p-field p-col-12 p-md-6 p-mt-4",4,"ngIf"],[1,"p-field","p-col-12","p-md-12"],["routerLink","/assets/documents/sample.xlsx","target","_blank",1,"pi","pi-file-excel"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","rows","paginator","globalFilterFields","rowHover","showCurrentPageReport"],["dt",""],["pTemplate","caption"],["pTemplate","body"],["pTemplate","summary"],["header","You are about to upload student data",3,"visible","visibleChange"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","footer"],[1,"pi","pi-user-plus"],[1,"p-ml-2"],[1,"p-field","p-col-12","p-md-6","p-mt-4"],["type","file","size","60",3,"change"],["myInput",""],[1,"p-d-flex","p-ai-center","p-jc-between"],[1,"p-m-0"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search student...",3,"input"],["pSortableColumn","student_id"],["field","student_id"],["pSortableColumn","name"],["field","name"],["pSortableColumn","gender"],["field","gender"],["pSortableColumn","phone"],["field","phone"],["pSortableColumn","email"],["field","email"],[2,"font-size","11px"],[2,"font-size","10px"],["label","Cancel","styleClass","p-button-outlined p-button-danger",3,"click"],["label","Upload data","styleClass","p-button-info",3,"click"]],template:function(t,e){1&t&&(l._UZ(0,"p-toast",0),l.TgZ(1,"p-card"),l.TgZ(2,"p-tabView",1),l.TgZ(3,"p-tabPanel"),l.YNc(4,T,3,0,"ng-template",2),l.TgZ(5,"div",3),l.TgZ(6,"div",4),l.TgZ(7,"span",5),l.TgZ(8,"p-dropdown",6),l.NdJ("ngModelChange",function(t){return e.school_calendar_id=t}),l.qZA(),l.TgZ(9,"label",7),l._uU(10,"Select Calendar Year "),l.qZA(),l.qZA(),l.qZA(),l.TgZ(11,"div",4),l.TgZ(12,"span",5),l.TgZ(13,"p-dropdown",8),l.NdJ("ngModelChange",function(t){return e.class_id=t})("onChange",function(){return e.getStudents()}),l.qZA(),l.TgZ(14,"label",7),l._uU(15,"Select Class"),l.qZA(),l.qZA(),l.qZA(),l.YNc(16,m,3,0,"div",9),l.qZA(),l.TgZ(17,"div",3),l.TgZ(18,"div",10),l.TgZ(19,"p"),l._uU(20," To upload new students to selected class, please upload .xlsx file. "),l.TgZ(21,"a",11),l._uU(22,"download sample"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(23,"p-table",12,13),l.YNc(25,q,6,0,"ng-template",14),l.YNc(26,b,17,0,"ng-template",2),l.YNc(27,U,12,5,"ng-template",15),l.YNc(28,x,2,1,"ng-template",16),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(29,"p-dialog",17),l.NdJ("visibleChange",function(t){return e.display=t}),l.TgZ(30,"p-table",18),l.YNc(31,v,13,0,"ng-template",2),l.YNc(32,S,13,6,"ng-template",15),l.qZA(),l.YNc(33,N,2,0,"ng-template",19),l.qZA()),2&t&&(l.xp6(8),l.Q6J("autoDisplayFirst",!1)("options",null==e.school_calendar?null:e.school_calendar.results)("ngModel",e.school_calendar_id),l.xp6(5),l.Q6J("autoDisplayFirst",!1)("options",null==e.grades?null:e.grades.class)("ngModel",e.class_id),l.xp6(3),l.Q6J("ngIf",e.school_calendar_id&&e.class_id),l.xp6(7),l.Q6J("value",null==e.students?null:e.students.data)("rows",10)("paginator",!0)("globalFilterFields",l.DdM(21,w))("rowHover",!0)("showCurrentPageReport",!0),l.xp6(6),l.Akn(l.DdM(22,C)),l.Q6J("visible",e.display),l.xp6(1),l.Q6J("value",e.data_file)("paginator",!0)("rows",5)("showCurrentPageReport",!0)("rowsPerPageOptions",l.DdM(23,y)))},directives:[u.FN,p.Z,c.xf,c.x4,a.jx,g.Lt,Z.JJ,Z.On,s.O5,i.yS,h.iA,_.V,f.o,h.lQ,h.fz,A.zx],styles:[""]}),t})(),data:{title:"Register Student",breadcrumb:"Registration",role:"REGISTER_STUDENT"}}];let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[i.Bz.forChild(R)],i.Bz]}),t})();var M=n(59165),I=n(22928);let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[s.ez,E,M.W,Z.u5,I.Ob]]}),t})()}}]);